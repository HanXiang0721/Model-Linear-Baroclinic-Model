
			  agcm5.3.1

	CCSR/NIES Atmospheric General Circulation Model 

			1994/06/05

○使用方法については, doc/Using.doc を読んでください.

○以前のバージョン(agcm5.2)との違い

* 時間積分スキーム(計算順序)の変更
      + 以前は, t-Δt の物理量(X(t-Δt))を用いて, 
	拡散放射過程の時間変化項(Fp[X(t-Δt)])を計算し, 
	それと力学過程による時間変化項(Fd[X(t)])を足して, 
	力学ルーチン(DYNMCS)でスペクトル空間で時間積分し,
	その結果(X(t+Δt)') に, その値を用いた湿潤過程の
	時間変化項(Fm[X(t+Δt)'])をPADJSTで足し込んでいた.

	X(t+Δt)' = X(t-Δt)  + 2Δt{ Fp[X(t-Δt)] + Fd[X(t)] }
	X(t+Δt)  = X(t+Δt)' + 2Δt  Fm[X(t+Δt)']
	 
	agcm5.3 では, まず,
	力学過程による時間変化項(Fd[X(t)])のみを用いてDYNMCSで積分を行い,
	その結果(X(t+Δt)")を用いて,
        拡散放射過程の時間変化項(Fp[X(t+Δt)"])と
	湿潤過程の時間変化項(Fm[X(t+Δt)"])とを計算し, 
	物理過程ルーチン(PHYSCS)で格子点上で時間積分を行うようにした.

	X(t+Δt)" = X(t-Δt)  + 2Δt  Fd[X(t)]
	X(t+Δt)  = X(t+Δt)" + 2Δt{ Fm[X(t+Δt)"] + Fp[X(t+Δt)"] }

      + 時間フィルターの扱いを変更し, 使用メモリを節約した.

* 力学過程の変更
      + トレーサー物質を任意の個数入れられるようにした.
	これによって, 水蒸気と雲水を予報変数として分離独立させた.
      + 水平拡散およびレーリー摩擦を各層ごとに独立に入れられるようにした.

* 物理過程の変更		
      + 中島/塚本放射を標準スキームとして組み込んだ(pradt.F).
      + 太陽入射の計算に離心率を考慮した(pradi.F)
      + 日射フラックスの天頂角による補正を各ステップで行うようにした(pradt.F)
      + 地表面温度の扱いを簡略化した. 表皮温度の扱いを止め,
	熱において, 積雪層と土壌第1層を区別しないようにした(pgsfc.F).
      + 地中の熱と土壌水分の拡散の扱いを, 固定した拡散係数を用いるように
	簡略化した(pland.F).
      + 土壌水分流出の見積りに「新バケツモデル」を採用した(pland.F).
      + 大規模凝結による雲水量算出の際の降水効率の表現を改良した.
	臨界雲水量を低温時(氷晶)と高温時(水)で区別し, 
	雪片落下の効果を入れた. また, 臨界値付近の降水効率の変化を
	滑らかにした(pmlsc.F).
      + 鉛直拡散における雲の効果(湿潤Richardson数)を改良した(pvdfm.F).
      + 境界層内の対流運動に伴う非局所的拡散の効果を導入した(ppblp.F).
      + 地表フラックスに自由対流による風速の効果を導入した(psfcm.F).
      + 内部予報変数の扱いを改良し, 
	なるべく正確なリスタートができるようにした(psave.F).
      + 鉛直拡散の混合距離を, 境界層と自由大気で変えるようにした(pvdfy.F)
      + 荒川積雲スキームのダウンドラフト, 中層を雲底とした積雲の
	取扱いを変更した(pcuma.F)
      + pgprm.F を pgbnd.F に取り込み、廃止した(agcm5.3.1)。
      + 海氷の index を -1 とした。また、厚さを境界条件で与え、
        底の温度を -1.8 度として、熱伝導を考慮するようにした。
        (agcm5.3.1:pgbnd.F,pland.F)
      + 入射において, 年平均日変化ありの場合も取扱えるようにした.
        (agcm5.3.1:pradi.F)

* 時刻の扱いの変更
      + 時刻を表す変数を内部的に倍精度実数に一本化した(ucaln.F).
      + これにより, 初期値時刻, 境界条件の時刻などの扱いがより簡素化された.
      + 1年365日の暦, グレゴリオ歴(閏年あり)も扱えるようにした(ucaln.F).
	
* 入出力の変更
      + 入出力の形式としてバイナリ(gtool3)形式と書式付き形式が
	各ファイルごとに選択できるようにした(irwgd.F).
      + HISTORY 機能を強化した. また, HISTRG と HISTINに別れていたのを
	一本化した(ihist.F).
      + ファイル名の指定の書式を変更した(ifopn.F).
      + p面変換量および海面更正気圧の出力を可能にした(admin/as2po.F等).

* その他の機能の変更
      + 実行途中に, その時点でのリスタートファイル等を残して,
	終了させるような指令を外部から送ることができるようにした
	(ファイルの作成による, aquit.F).

* プログラム構成の変更
      + 全体を REAL*8 を用いるように書き直し, 自動倍精度オプションを
	用いないこととした.
      + gtool3, dcl から独立させ, 単体のみで用いることができるようにした.
	
○使用上の注意

* 各サブディレクトリでの, 用いるファイルの構成が以前と異なっている.

* NAMELIST の変数名が以前と異なっているものがある.
  agcm5.2 以前の NAMELIST 入力パラメータを与えるとエラーとなりうる.

* agcm5.2 以前のリスタートファイルは, 初期値としては用いることは可能だが,
  リスタートとはならない( GA* のみが使用される).

* 初期値, 境界値の時刻はこれまで TIME フィールドを見ていたが,
  DATE フィールド('19931226 145029'といったフィールド)を見るように
  変更されたので注意.

* オゾンのデータファイルとして, これまでのものは使用できない可能性がある.
  AITM1,AEND1 が緯度座標, AITM2,AEND2 が鉛直座標となっているものは,
  ヘッダを変更し, AITM1 を空白, AEND1 を 1, 
  AITM2,AEND2 を緯度座標, AITM3,AEND3 を鉛直座標としなければならない.

* 現在のところ, まだCPU時間,使用メモリの最適化は十分行っていない.

* gridx のファイルが異なる。これまでのものも使用可能だが、
  海氷が陸氷と同じ扱いとなる。
  agcm5.3.1 では、海氷は grice で(厚さで）指定する。

○コンパイル方法

* 環境変数 AGCMDIR をセットする 
   % setenv AGCMDIR ~/model/agcm5.3
* src/Mkinclude をエディトして, 
  解像度, nonstd ルーチン, コンパイルオプション等を変更する.
* ライブラリの構築
   % make lib 
* メインプログラムの作成
   % make gcm
